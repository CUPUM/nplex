import{p as x,i as T,b as H}from"./entry.BF9yKNlN.js";function M(e){const r=JSON.parse(e);return r.data&&(r.data=x(r.data)),r}function l(e){return HTMLElement.prototype.cloneNode.call(e)}function F(e,r=()=>{}){const u=async({action:a,result:c,reset:i=!0,invalidateAll:n=!0})=>{c.type==="success"&&(i&&HTMLFormElement.prototype.reset.call(e),n&&await T()),(location.origin+location.pathname===a.origin+a.pathname||c.type==="redirect"||c.type==="error")&&H(c)};async function m(a){var b,y,h,w,A;if(((b=a.submitter)!=null&&b.hasAttribute("formmethod")?a.submitter.formMethod:l(e).method)!=="post")return;a.preventDefault();const i=new URL((y=a.submitter)!=null&&y.hasAttribute("formaction")?a.submitter.formAction:l(e).action),n=(h=a.submitter)!=null&&h.hasAttribute("formenctype")?a.submitter.formEnctype:l(e).enctype,s=new FormData(e),p=(w=a.submitter)==null?void 0:w.getAttribute("name");p&&s.append(p,((A=a.submitter)==null?void 0:A.getAttribute("value"))??"");const d=new AbortController;let f=!1;const L=await r({action:i,cancel:()=>f=!0,controller:d,formData:s,formElement:e,submitter:a.submitter})??u;if(f)return;let o;try{const t=new Headers({accept:"application/json","x-sveltekit-action":"true"});n!=="multipart/form-data"&&t.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(n)?n:"application/x-www-form-urlencoded");const g=n==="multipart/form-data"?s:new URLSearchParams(s),E=await fetch(i,{method:"POST",headers:t,cache:"no-store",body:g,signal:d.signal});o=M(await E.text()),o.type==="error"&&(o.status=E.status)}catch(t){if((t==null?void 0:t.name)==="AbortError")return;o={type:"error",error:t}}L({action:i,formData:s,formElement:e,update:t=>u({action:i,result:o,reset:t==null?void 0:t.reset,invalidateAll:t==null?void 0:t.invalidateAll}),result:o})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",m),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",m)}}}export{F as e};
