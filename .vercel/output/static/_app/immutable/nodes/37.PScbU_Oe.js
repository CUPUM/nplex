var pe=Object.defineProperty;var Ht=t=>{throw TypeError(t)};var be=(t,e,n)=>e in t?pe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var st=(t,e,n)=>be(t,typeof e!="symbol"?e+"":e,n),Bt=(t,e,n)=>e.has(t)||Ht("Cannot "+n);var k=(t,e,n)=>(Bt(t,e,"read from private field"),n?n.call(t):e.get(t)),X=(t,e,n)=>e.has(t)?Ht("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Dt=(t,e,n,r)=>(Bt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);import"../chunks/disclose-version.Bg9kRutz.js";import{c as at,a as m,f as C,t as M,b as p,s as d,d as ve}from"../chunks/template.CYbmh4h0.js";import{p as qt,t as x,g,s as H,u as I,a as Nt,b as B,d as Q}from"../chunks/runtime.DjgYXsSk.js";import{s as ct,a as E,d as ye}from"../chunks/render.B8uQQetn.js";import{e as kt,i as Xt}from"../chunks/each.CVL6L7bf.js";import{a as tt}from"../chunks/actions.DlEPaH3k.js";import{s as O,a as At,e as Wt,r as _e}from"../chunks/attributes.BNVf-LtF.js";import{i as Qt,t as Mt,b as $e,s as Zt,e as te,f as ee,d as ne}from"../chunks/index.B9DhiAzX.js";import{l as ut,s as W}from"../chunks/props.B2871YNw.js";import{s as Tt,a as T}from"../chunks/store.9ZQN09u1.js";import{be as we,B as xe,bf as ke,G as Me,bg as je,bh as Fe,bi as Pe,bj as Ie,aO as Oe}from"../chunks/messages.CGgarydI.js";import{D as Re}from"../chunks/dashboard-sub-header.BBUxUWnj.js";import{D as re}from"../chunks/dashboard-sub-section.BTSYr39U.js";import{e as Ut,I as wt}from"../chunks/client.dtU0Iyvs.js";import{f as ae}from"../chunks/index.DpRu7_UM.js";import{p as z}from"../chunks/proxy.Cn1c9iIJ.js";import{a as De}from"../chunks/await.CCLGkKUQ.js";import{b as xt}from"../chunks/this.C2iGNKnu.js";import{D as Ee}from"../chunks/dialog.svelte.gaaCbzH3.js";import{D as ze}from"../chunks/dialog-box.IlpNd8qH.js";import{F as Ae}from"../chunks/field.r2CZdIq6.js";import{M as Le}from"../chunks/constants.Dum3VLoP.js";import{i as Se}from"../chunks/url.CMTy2O2u.js";import{W as qe}from"../chunks/wrench.BLQihNIX.js";import{d as dt}from"../chunks/misc.BGa3BRog.js";import{I as ht}from"../chunks/Icon.Be5s3T4S.js";import{C as Ne}from"../chunks/check.CQ55fSLP.js";import{i as Te}from"../chunks/if.C12WoQaB.js";import{p as Ue}from"../chunks/stores.yKo6NxPo.js";import{r as Et}from"../chunks/ripple.DEHVMGsW.js";import{P as Ce}from"../chunks/constants.D0gk7bpZ.js";import{g as Ge}from"../chunks/entry.BF9yKNlN.js";import{X as Ve}from"../chunks/x.DtZFMutn.js";function He(t,e){const n=ut(e,["children","$$slots","$$events","$$legacy"]);ht(t,W({name:"image-plus"},()=>n,{iconNode:[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]],children:(a,o)=>{var s=at(),i=C(s);ct(i,dt(e),{}),m(a,s)},$$slots:{default:!0},$$legacy:!0}))}function Be(t,e){const n=ut(e,["children","$$slots","$$events","$$legacy"]);ht(t,W({name:"square"},()=>n,{iconNode:[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}]],children:(a,o)=>{var s=at(),i=C(s);ct(i,dt(e),{}),m(a,s)},$$slots:{default:!0},$$legacy:!0}))}function We(t,e){const n=ut(e,["children","$$slots","$$events","$$legacy"]);ht(t,W({name:"trash"},()=>n,{iconNode:[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}]],children:(a,o)=>{var s=at(),i=C(s);ct(i,dt(e),{}),m(a,s)},$$slots:{default:!0},$$legacy:!0}))}function Ke(t,e){const n=ut(e,["children","$$slots","$$events","$$legacy"]);ht(t,W({name:"upload"},()=>n,{iconNode:[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["polyline",{points:"17 8 12 3 7 8"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15"}]],children:(a,o)=>{var s=at(),i=C(s);ct(i,dt(e),{}),m(a,s)},$$slots:{default:!0},$$legacy:!0}))}function Je(t,e){const n=ut(e,["children","$$slots","$$events","$$legacy"]);ht(t,W({name:"wallpaper"},()=>n,{iconNode:[["circle",{cx:"8",cy:"9",r:"2"}],["path",{d:"m9 17 6.1-6.1a2 2 0 0 1 2.81.01L22 15V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2"}],["path",{d:"M8 21h8"}],["path",{d:"M12 17v4"}]],children:(a,o)=>{var s=at(),i=C(s);ct(i,dt(e),{}),m(a,s)},$$slots:{default:!0},$$legacy:!0}))}var Ye=M('<button class="button button-cta"><!> </button>'),Xe=M("<option> </option>"),Qe=M('<select name="imageTypeId" class="button button-bordered"><!></select>'),Ze=M('<form method="POST"><!></form>'),tn=M('<figure class="bg-card pt-md group/card absolute relative flex h-full w-full flex-col-reverse rounded-sm"><img class="rounded-inherit absolute top-0 left-0 h-full w-full object-cover"> <button></button> <div class="rounded-inherit after:rounded-inherit p-input-padding gap-gap after:content after:from-popover after:duration-medium pointer-events-none relative z-1 flex h-full flex-col transition-all after:pointer-events-none after:absolute after:inset-0 after:-z-1 after:bg-gradient-to-t after:to-transparent after:opacity-0 after:transition-all group-hover/card:after:opacity-100"><header class="flex-1"> </header> <menu class="gap-input-group-gap *:bg-overlay/75 flex flex-row flex-wrap items-start text-xs *:pointer-events-auto"><button><!> </button> <button class="button button-ghost backdrop-blur-sm" data-danger="" type="submit" name="deleteId" formaction="?/delete"> <!></button> <button class="button button-ghost backdrop-blur-sm" type="submit" name="bannerId"><!> </button></menu></div></figure> <!>',1);function en(t,e){qt(e,!0);const n=Tt(),r=()=>T(e.form,"$galleryForm",n),a=()=>T(b,"$form",n),o=()=>T(e.formId,"$galleryFormId",n),s=()=>T(e.submitter,"$gallerySubmitter",n),i=()=>T(y,"$submitter",n);let c=B(void 0),u=B(void 0),h=B(void 0);const{form:b,enhance:f,submitter:y,formId:_}=Ut(e.imageForm),v=new Ee;let $=Q(()=>r().bannerId===a().id);var j=tn(),R=C(j),w=p(R);x(()=>O(w,"src",Se(a().storageName,{resize:{fit:"inside",height:250},quality:.8})));var F=d(d(w,!0));let ot;var ft=d(d(F,!0)),mt=p(ft),D=p(mt),P=d(d(mt,!0)),L=p(P);let A;var S=p(L);qe(S,{});var q=d(S,!0);x(()=>E(q,` ${we()??""}`));var G=d(d(L,!0));xt(G,pt=>H(u,z(pt)),()=>g(u));var K=p(G);x(()=>E(K,`${xe()??""} `));var Pt=d(K),V=Q(()=>s()===g(u));wt(Pt,{icon:We,get busy(){return g(V)}});var N=d(d(G,!0));xt(N,pt=>H(h,z(pt)),()=>g(h));var It=p(N),gt=Q(()=>g($)?Je:Be),ie=Q(()=>s()===g(h));wt(It,{get icon(){return g(gt)},get busy(){return g(ie)}});var le=d(It,!0);x(()=>E(le,ke()));var ce=d(d(R,!0));ze(ce,{dialog:v,class:"min-w-sm",title:bt=>{},actions:bt=>{var vt=Ye();xt(vt,Y=>H(c,z(Y)),()=>g(c));var J=p(vt),Ot=Q(()=>g(c)===i());wt(J,{icon:Ne,get busy(){return g(Ot)}});var yt=d(J,!0);x(()=>E(yt,Me())),m(bt,vt)},children:(bt,vt)=>{var J=Ze(),Ot=p(J);Ae(Ot,{label:Y=>{var Rt=ve(Y);x(()=>E(Rt,je())),m(Y,Rt)},children:(Y,Rt)=>{var Ct=Qe(),ue=p(Ct);De(ue,()=>e.types,null,(de,he)=>{var Gt=at(),fe=C(Gt);kt(fe,65,()=>g(he),Xt,(me,_t,Un)=>{var $t=Xe(),Vt,ge=p($t);x(()=>{Vt!==(Vt=I(_t).id)&&($t.value=($t.__value=I(_t).id)==null?"":I(_t).id),E(ge,I(_t).title)}),m(me,$t)}),m(de,Gt)}),m(Y,Ct)},$$slots:{default:!0}}),tt(J,yt=>f(yt)),m(bt,J)},$$slots:{default:!0}}),x(()=>{O(R,"data-mode",Le.DARK),O(w,"alt",`image-${a().id??""}`),ot=At(F,ot,{class:"fill",...v.triggerAttributes},!0,""),E(D,a().id),A=At(L,A,{class:"button button-ghost backdrop-blur-sm",...v.triggerAttributes},!0,""),Wt(G,a().id),O(G,"form",o()),O(N,"data-state",g($)?"checked":void 0),O(N,"form",o()),Wt(N,a().id),O(N,"formaction",`?/${(g($)?"demote":"promote")??""}`)}),m(t,j),Nt()}const nn={JPEG:"image/jpeg",TIF:"image/tiff",PNG:"image/png",AVIF:"image/avif"},rn=Object.values(nn);function an(t,e){if(typeof e=="number")return Math.min(1,e/Math.max(t.width,t.height));const n=e.width?e.width/t.width:1,r=e.height?e.height/t.height:1;return Math.min(n,r,1)}async function Kt(t,{filename:e,max:n,quality:r=1,format:a="webp"}){const o=t instanceof File?URL.createObjectURL(t):t,s=document.createElement("canvas"),i=`image/${a}`,c=s.getContext("2d"),u=new Image;return u.src=o,new Promise(h=>{u.onload=function(){const b=an(u,n);s.width=b*u.width,s.height=b*u.height,c==null||c.drawImage(u,0,0,u.width,u.height,0,0,s.width,s.height),s.toBlob(f=>{if(!f)throw new Error("No blob returned inside image onload callback of transform.");const y=new File([f],`${e}.${a}`,{type:i});t instanceof File&&URL.revokeObjectURL(o),h({file:y,width:u.width,height:u.height})},i,r)}})}function on(t){return!(!t.target||!("files"in t.target)||!(t.target.files instanceof FileList))}var U,Yt,lt,et,nt,rt;const Ft=class Ft{constructor({parse:e,onDelete:n,multiple:r,accept:a=rn,resetData:o=!0,resetValue:s=!0}){X(this,lt);X(this,et,B(z([])));st(this,"onDelete");st(this,"resetData");st(this,"resetValue");X(this,nt,B());X(this,rt,B());Dt(this,lt,e),this.onDelete=n,k(this,nt).v=z(r),k(this,rt).v=z(a),this.resetData=o,this.resetValue=s}get multiple(){return g(k(this,nt))}set multiple(e){H(k(this,nt),z(e))}get accept(){return g(k(this,rt))}set accept(e){H(k(this,rt),z(e))}get parsed(){return g(k(this,et))}get inputAttributes(){const e=this;return{type:"file",get multiple(){return e.multiple},get accept(){var n;return(n=e.accept)==null?void 0:n.join(",")},async onchange(n){on(n)&&(e.resetData&&e.deleteAll(),n.target.files.length&&(await Promise.all(Array.from(n.target.files).map(async r=>{var o;const a=await k(o=e,lt).call(o,r);new Ft.ParsedImage(a,e)})),e.resetValue&&"value"in n.target&&(n.target.value="")))}}}deleteAll(){this.onDelete&&g(k(this,et)).forEach(e=>this.onDelete(e.data)),H(k(this,et),z([]))}};lt=new WeakMap,et=new WeakMap,nt=new WeakMap,rt=new WeakMap,st(Ft,"ParsedImage",(Yt=class{constructor(e,n){X(this,U);this.data=e,Dt(this,U,n),n.parsed.push(this)}delete(){const e=k(this,U).parsed.indexOf(this);e>-1&&k(this,U).parsed.splice(e,1),k(this,U).onDelete&&k(this,U).onDelete(this.data)}},U=new WeakMap,Yt));let Lt=Ft;function sn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ln={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const it=ln,oe={};for(const t of Object.keys(it))oe[it[t]]=t;const l={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var se=l;for(const t of Object.keys(l)){if(!("channels"in l[t]))throw new Error("missing channels property: "+t);if(!("labels"in l[t]))throw new Error("missing channel labels property: "+t);if(l[t].labels.length!==l[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:n}=l[t];delete l[t].channels,delete l[t].labels,Object.defineProperty(l[t],"channels",{value:e}),Object.defineProperty(l[t],"labels",{value:n})}l.rgb.hsl=function(t){const e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.min(e,n,r),o=Math.max(e,n,r),s=o-a;let i,c;o===a?i=0:e===o?i=(n-r)/s:n===o?i=2+(r-e)/s:r===o&&(i=4+(e-n)/s),i=Math.min(i*60,360),i<0&&(i+=360);const u=(a+o)/2;return o===a?c=0:u<=.5?c=s/(o+a):c=s/(2-o-a),[i,c*100,u*100]};l.rgb.hsv=function(t){let e,n,r,a,o;const s=t[0]/255,i=t[1]/255,c=t[2]/255,u=Math.max(s,i,c),h=u-Math.min(s,i,c),b=function(f){return(u-f)/6/h+1/2};return h===0?(a=0,o=0):(o=h/u,e=b(s),n=b(i),r=b(c),s===u?a=r-n:i===u?a=1/3+e-r:c===u&&(a=2/3+n-e),a<0?a+=1:a>1&&(a-=1)),[a*360,o*100,u*100]};l.rgb.hwb=function(t){const e=t[0],n=t[1];let r=t[2];const a=l.rgb.hsl(t)[0],o=1/255*Math.min(e,Math.min(n,r));return r=1-1/255*Math.max(e,Math.max(n,r)),[a,o*100,r*100]};l.rgb.cmyk=function(t){const e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.min(1-e,1-n,1-r),o=(1-e-a)/(1-a)||0,s=(1-n-a)/(1-a)||0,i=(1-r-a)/(1-a)||0;return[o*100,s*100,i*100,a*100]};function cn(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}l.rgb.keyword=function(t){const e=oe[t];if(e)return e;let n=1/0,r;for(const a of Object.keys(it)){const o=it[a],s=cn(t,o);s<n&&(n=s,r=a)}return r};l.keyword.rgb=function(t){return it[t]};l.rgb.xyz=function(t){let e=t[0]/255,n=t[1]/255,r=t[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92;const a=e*.4124+n*.3576+r*.1805,o=e*.2126+n*.7152+r*.0722,s=e*.0193+n*.1192+r*.9505;return[a*100,o*100,s*100]};l.rgb.lab=function(t){const e=l.rgb.xyz(t);let n=e[0],r=e[1],a=e[2];n/=95.047,r/=100,a/=108.883,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const o=116*r-16,s=500*(n-r),i=200*(r-a);return[o,s,i]};l.hsl.rgb=function(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100;let a,o,s;if(n===0)return s=r*255,[s,s,s];r<.5?a=r*(1+n):a=r+n-r*n;const i=2*r-a,c=[0,0,0];for(let u=0;u<3;u++)o=e+1/3*-(u-1),o<0&&o++,o>1&&o--,6*o<1?s=i+(a-i)*6*o:2*o<1?s=a:3*o<2?s=i+(a-i)*(2/3-o)*6:s=i,c[u]=s*255;return c};l.hsl.hsv=function(t){const e=t[0];let n=t[1]/100,r=t[2]/100,a=n;const o=Math.max(r,.01);r*=2,n*=r<=1?r:2-r,a*=o<=1?o:2-o;const s=(r+n)/2,i=r===0?2*a/(o+a):2*n/(r+n);return[e,i*100,s*100]};l.hsv.rgb=function(t){const e=t[0]/60,n=t[1]/100;let r=t[2]/100;const a=Math.floor(e)%6,o=e-Math.floor(e),s=255*r*(1-n),i=255*r*(1-n*o),c=255*r*(1-n*(1-o));switch(r*=255,a){case 0:return[r,c,s];case 1:return[i,r,s];case 2:return[s,r,c];case 3:return[s,i,r];case 4:return[c,s,r];case 5:return[r,s,i]}};l.hsv.hsl=function(t){const e=t[0],n=t[1]/100,r=t[2]/100,a=Math.max(r,.01);let o,s;s=(2-n)*r;const i=(2-n)*a;return o=n*a,o/=i<=1?i:2-i,o=o||0,s/=2,[e,o*100,s*100]};l.hwb.rgb=function(t){const e=t[0]/360;let n=t[1]/100,r=t[2]/100;const a=n+r;let o;a>1&&(n/=a,r/=a);const s=Math.floor(6*e),i=1-r;o=6*e-s,s&1&&(o=1-o);const c=n+o*(i-n);let u,h,b;switch(s){default:case 6:case 0:u=i,h=c,b=n;break;case 1:u=c,h=i,b=n;break;case 2:u=n,h=i,b=c;break;case 3:u=n,h=c,b=i;break;case 4:u=c,h=n,b=i;break;case 5:u=i,h=n,b=c;break}return[u*255,h*255,b*255]};l.cmyk.rgb=function(t){const e=t[0]/100,n=t[1]/100,r=t[2]/100,a=t[3]/100,o=1-Math.min(1,e*(1-a)+a),s=1-Math.min(1,n*(1-a)+a),i=1-Math.min(1,r*(1-a)+a);return[o*255,s*255,i*255]};l.xyz.rgb=function(t){const e=t[0]/100,n=t[1]/100,r=t[2]/100;let a,o,s;return a=e*3.2406+n*-1.5372+r*-.4986,o=e*-.9689+n*1.8758+r*.0415,s=e*.0557+n*-.204+r*1.057,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),s=Math.min(Math.max(0,s),1),[a*255,o*255,s*255]};l.xyz.lab=function(t){let e=t[0],n=t[1],r=t[2];e/=95.047,n/=100,r/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;const a=116*n-16,o=500*(e-n),s=200*(n-r);return[a,o,s]};l.lab.xyz=function(t){const e=t[0],n=t[1],r=t[2];let a,o,s;o=(e+16)/116,a=n/500+o,s=o-r/200;const i=o**3,c=a**3,u=s**3;return o=i>.008856?i:(o-16/116)/7.787,a=c>.008856?c:(a-16/116)/7.787,s=u>.008856?u:(s-16/116)/7.787,a*=95.047,o*=100,s*=108.883,[a,o,s]};l.lab.lch=function(t){const e=t[0],n=t[1],r=t[2];let a;a=Math.atan2(r,n)*360/2/Math.PI,a<0&&(a+=360);const s=Math.sqrt(n*n+r*r);return[e,s,a]};l.lch.lab=function(t){const e=t[0],n=t[1],a=t[2]/360*2*Math.PI,o=n*Math.cos(a),s=n*Math.sin(a);return[e,o,s]};l.rgb.ansi16=function(t,e=null){const[n,r,a]=t;let o=e===null?l.rgb.hsv(t)[2]:e;if(o=Math.round(o/50),o===0)return 30;let s=30+(Math.round(a/255)<<2|Math.round(r/255)<<1|Math.round(n/255));return o===2&&(s+=60),s};l.hsv.ansi16=function(t){return l.rgb.ansi16(l.hsv.rgb(t),t[2])};l.rgb.ansi256=function(t){const e=t[0],n=t[1],r=t[2];return e===n&&n===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)};l.ansi16.rgb=function(t){let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const n=(~~(t>50)+1)*.5,r=(e&1)*n*255,a=(e>>1&1)*n*255,o=(e>>2&1)*n*255;return[r,a,o]};l.ansi256.rgb=function(t){if(t>=232){const o=(t-232)*10+8;return[o,o,o]}t-=16;let e;const n=Math.floor(t/36)/5*255,r=Math.floor((e=t%36)/6)/5*255,a=e%6/5*255;return[n,r,a]};l.rgb.hex=function(t){const n=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".substring(n.length)+n};l.hex.rgb=function(t){const e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let n=e[0];e[0].length===3&&(n=n.split("").map(i=>i+i).join(""));const r=parseInt(n,16),a=r>>16&255,o=r>>8&255,s=r&255;return[a,o,s]};l.rgb.hcg=function(t){const e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(Math.max(e,n),r),o=Math.min(Math.min(e,n),r),s=a-o;let i,c;return s<1?i=o/(1-s):i=0,s<=0?c=0:a===e?c=(n-r)/s%6:a===n?c=2+(r-e)/s:c=4+(e-n)/s,c/=6,c%=1,[c*360,s*100,i*100]};l.hsl.hcg=function(t){const e=t[1]/100,n=t[2]/100,r=n<.5?2*e*n:2*e*(1-n);let a=0;return r<1&&(a=(n-.5*r)/(1-r)),[t[0],r*100,a*100]};l.hsv.hcg=function(t){const e=t[1]/100,n=t[2]/100,r=e*n;let a=0;return r<1&&(a=(n-r)/(1-r)),[t[0],r*100,a*100]};l.hcg.rgb=function(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100;if(n===0)return[r*255,r*255,r*255];const a=[0,0,0],o=e%1*6,s=o%1,i=1-s;let c=0;switch(Math.floor(o)){case 0:a[0]=1,a[1]=s,a[2]=0;break;case 1:a[0]=i,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=s;break;case 3:a[0]=0,a[1]=i,a[2]=1;break;case 4:a[0]=s,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=i}return c=(1-n)*r,[(n*a[0]+c)*255,(n*a[1]+c)*255,(n*a[2]+c)*255]};l.hcg.hsv=function(t){const e=t[1]/100,n=t[2]/100,r=e+n*(1-e);let a=0;return r>0&&(a=e/r),[t[0],a*100,r*100]};l.hcg.hsl=function(t){const e=t[1]/100,r=t[2]/100*(1-e)+.5*e;let a=0;return r>0&&r<.5?a=e/(2*r):r>=.5&&r<1&&(a=e/(2*(1-r))),[t[0],a*100,r*100]};l.hcg.hwb=function(t){const e=t[1]/100,n=t[2]/100,r=e+n*(1-e);return[t[0],(r-e)*100,(1-r)*100]};l.hwb.hcg=function(t){const e=t[1]/100,r=1-t[2]/100,a=r-e;let o=0;return a<1&&(o=(r-a)/(1-a)),[t[0],a*100,o*100]};l.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};l.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};l.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};l.gray.hsl=function(t){return[0,0,t[0]]};l.gray.hsv=l.gray.hsl;l.gray.hwb=function(t){return[0,100,t[0]]};l.gray.cmyk=function(t){return[0,0,0,t[0]]};l.gray.lab=function(t){return[t[0],0,0]};l.gray.hex=function(t){const e=Math.round(t[0]/100*255)&255,r=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(r.length)+r};l.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};const jt=se;function un(){const t={},e=Object.keys(jt);for(let n=e.length,r=0;r<n;r++)t[e[r]]={distance:-1,parent:null};return t}function dn(t){const e=un(),n=[t];for(e[t].distance=0;n.length;){const r=n.pop(),a=Object.keys(jt[r]);for(let o=a.length,s=0;s<o;s++){const i=a[s],c=e[i];c.distance===-1&&(c.distance=e[r].distance+1,c.parent=r,n.unshift(i))}}return e}function hn(t,e){return function(n){return e(t(n))}}function fn(t,e){const n=[e[t].parent,t];let r=jt[e[t].parent][t],a=e[t].parent;for(;e[a].parent;)n.unshift(e[a].parent),r=hn(jt[e[a].parent][a],r),a=e[a].parent;return r.conversion=n,r}var mn=function(t){const e=dn(t),n={},r=Object.keys(e);for(let a=r.length,o=0;o<a;o++){const s=r[o];e[s].parent!==null&&(n[s]=fn(s,e))}return n};const St=se,gn=mn,Z={},pn=Object.keys(St);function bn(t){const e=function(...n){const r=n[0];return r==null?r:(r.length>1&&(n=r),t(n))};return"conversion"in t&&(e.conversion=t.conversion),e}function vn(t){const e=function(...n){const r=n[0];if(r==null)return r;r.length>1&&(n=r);const a=t(n);if(typeof a=="object")for(let o=a.length,s=0;s<o;s++)a[s]=Math.round(a[s]);return a};return"conversion"in t&&(e.conversion=t.conversion),e}pn.forEach(t=>{Z[t]={},Object.defineProperty(Z[t],"channels",{value:St[t].channels}),Object.defineProperty(Z[t],"labels",{value:St[t].labels});const e=gn(t);Object.keys(e).forEach(r=>{const a=e[r];Z[t][r]=vn(a),Z[t][r].raw=bn(a)})});var yn=Z;const Jt=sn(yn);var _n=t=>typeof t=="string"?t:t.src,$n=({amount:t=3,format:e="array",group:n=20,sample:r=10}={})=>({amount:t,format:e,group:n,sample:r}),wn=(t,e)=>{var n=t.map(r=>{var a=Array.isArray(r)?r:r.split(",").map(Number);return e.format==="hex"?xn(a):a});return e.amount===1||n.length===1?n[0]:n},zt=(t,e)=>{var n=Math.round(t/e)*e;return Math.min(n,255)},xn=t=>"#"+t.map(e=>{var n=e.toString(16);return n.length===1?"0"+n:n}).join(""),kn=t=>new Promise((e,n)=>{var r=document.createElement("canvas"),a=r.getContext("2d"),o=new Image;o.onload=()=>{r.height=o.height,r.width=o.width,a.drawImage(o,0,0);var s=a.getImageData(0,0,o.width,o.height).data;e(s)},o.onerror=()=>n(Error("Image loading failed.")),o.crossOrigin="",o.src=t}),Mn=(t,e)=>{for(var n=4*e.sample,r={},a=0;a<t.length;a+=n){var o=[zt(t[a],e.group),zt(t[a+1],e.group),zt(t[a+2],e.group)].join();r[o]=r[o]?r[o]+1:1}return wn(Object.entries(r).sort(([s,i],[c,u])=>i>u?-1:1).slice(0,e.amount).map(([s])=>s),e)},jn=(t,e,n)=>new Promise((r,a)=>kn(_n(e)).then(o=>r(t(o,$n(n)))).catch(o=>a(o))),Fn=(t,e)=>jn(Mn,t,e),Pn=M("<h3> </h3>"),In=M('<div class="bg-[data(hex)]"></div>'),On=(t,e)=>I(e).delete(),Rn=M('<div><img> <div></div> <menu><button class="button button-ghost aspect-square" data-danger="" type="button"><!></button></menu></div>'),Dn=M('<button class="button button-cta" type="submit"> <!></button>'),En=M('<form action="?/upload" method="POST" class="gap-padding flex flex-row flex-wrap self-stretch"><label class="p-padding border-dim rounded-input group/button relative flex aspect-square cursor-pointer items-center justify-center border border-dashed"><span class="button button-dashed"> <!></span> <input></label> <!> <!></form>');function zn(t,e){qt(e,!0);const n=Tt(),r=()=>T(c,"$formId",n),a=()=>T(b,"$submitter",n);let o=B(void 0);const s=new Lt({multiple:!0,resetData:!1,async parse(f){const[y,_,v]=await Promise.all([Kt(f,{filename:`parsed-${f.name}.webp`,max:1500,format:"webp"}),Kt(f,{filename:`preview-${f.name}`,max:350,quality:.8,format:"webp"}),new Promise(async j=>{const R=URL.createObjectURL(f),w=await Fn(R,{amount:Ce,group:40});URL.revokeObjectURL(R),j({hex:w.map(F=>Jt.rgb.hex(F)),lab:w.map(F=>Jt.rgb.lab(F))})})]),$=URL.createObjectURL(_.file);return{...y,url:$,...v}},onDelete(f){URL.revokeObjectURL(f.url)}}),{form:i,formId:c,errors:u,enhance:h,submitter:b}=Ut(e.newImagesForm,{dataType:"json",resetForm:!0,async onSubmit(f){const y=[];await Promise.allSettled(s.parsed.map(async _=>{const $=await(await fetch(`/edit/projects/${Ge(Ue).params.projectId}/gallery/presign`,{method:"GET"})).json(),j=new FormData;Object.entries($.post.fields).forEach(([w,F])=>{F&&j.append(w,F)}),j.append("file",_.data.file),(await fetch($.post.url,{method:"POST",body:j})).ok&&y.push({storageName:$.name,colorPaletteLAB:_.data.lab,height:_.data.height,width:_.data.width})})),i.set({images:y})},onResult(f){f.result.type==="success"&&s.deleteAll()}});re(t,{header:y=>{var _=Pn(),v=p(_);x(()=>E(v,Fe())),m(y,_)},children:(y,_)=>{var v=En(),$=p(v),j=p($),R=p(j);x(()=>E(R,`${Pe()??""} `));var w=d(R);He(w,{});var F=d(d(j,!0));_e(F);let ot;var ft=d(d($,!0));kt(ft,87,()=>s.parsed,(D,P)=>I(D).data.url,(D,P,L)=>{var A=Rn();Qt(A,()=>ae,()=>({duration(V){return 150+V/25},easing:ne})),Mt(1,A,()=>Zt,()=>({start:.9,duration:500,easing:$e,delay:I(L)*50}));var S=p(A),q=d(d(S,!0));kt(q,73,()=>I(P).data.hex,Xt,(V,N,It)=>{var gt=In();x(()=>O(gt,"data-hex",`#${I(N)??""}`)),m(V,gt)});var G=d(d(q,!0)),K=p(G);K.__click=[On,P];var Pt=p(K);Ve(Pt,{}),x(()=>{O(S,"src",I(P).data.url),O(S,"alt",`Preview image for ${I(P).data.url??""}`)}),tt(K,V=>Et(V)),m(D,A)});var mt=d(d(ft,!0));Te(mt,()=>s.parsed.length,D=>{var P=Dn();xt(P,q=>H(o,z(q)),()=>g(o)),Mt(1,P,()=>ee,()=>({y:8,easing:te,duration:750}));var L=p(P);x(()=>E(L,`${Ie()??""} `));var A=d(L),S=Q(()=>g(o)===a());wt(A,{get busy(){return g(S)},icon:Ke}),tt(P,q=>Et(q)),m(D,P)}),x(()=>{O(v,"id",r()),ot=At(F,ot,{form:"omit",class:"sr-only",name:"images",...s.inputAttributes},!0,"")}),tt(v,D=>h(D)),tt($,D=>Et(D)),m(y,v)},$$slots:{default:!0}}),Nt()}ye(["click"]);var An=M("<h2> </h2>"),Ln=M("<h3>Images</h3>"),Sn=M('<li class="relative aspect-square"><!></li>'),qn=M('<ul class="gap-padding grid grid-cols-[repeat(auto-fill,minmax(var(--width-xs),1fr))] self-stretch"></ul>'),Nn=M('<!> <!> <form method="POST" class="sr-only"></form> <!>',1);function wr(t,e){qt(e,!0);const n=Tt(),r=()=>T(o,"$formId",n),a=Ut(e.data.galleryForm,{invalidateAll:"force"}),{formId:o,enhance:s}=a;var i=Nn(),c=C(i);Re(c,{children:(f,y)=>{var _=An(),v=p(_);x(()=>E(v,Oe())),m(f,_)},$$slots:{default:!0}});var u=d(d(c,!0));zn(u,W(()=>e.data));var h=d(d(u,!0)),b=d(d(h,!0));re(b,{header:y=>{var _=Ln();m(y,_)},children:(y,_)=>{var v=qn();kt(v,95,()=>e.data.imageForms,($,j)=>I($).id,($,j,R)=>{var w=Sn();Qt(w,()=>ae,()=>({duration:250,easing:ne})),Mt(1,w,()=>ee,()=>({y:6,easing:te})),Mt(2,w,()=>Zt,()=>({duration:50,start:.95}));var F=p(w);en(F,W({get imageForm(){return I(j)}},a,{get types(){return e.data.types}})),m($,w)}),m(y,v)},$$slots:{default:!0}}),x(()=>O(h,"id",r())),tt(h,f=>s(f)),m(t,i),Nt()}export{wr as component};
